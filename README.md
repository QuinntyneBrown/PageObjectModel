# Playwright POM Generator (ppg)

A .NET CLI tool that automatically generates Playwright Page Object Model (POM) tests for Angular applications.

## Features

- ğŸ¯ **Automatic Angular Analysis** - Scans Angular workspaces and applications to detect components
- ğŸ“„ **Page Object Generation** - Creates type-safe TypeScript page objects with locators
- ğŸ§ª **Test Scaffolding** - Generates Playwright test specs with fixture integration
- ğŸ”Œ **SignalR Mock Support** - Generates RxJS-based SignalR mock fixtures for real-time testing
- âš™ï¸ **Configurable Output** - Customizable file headers and test file suffixes
- ğŸ› ï¸ **CI/CD Ready** - Command-line interface for easy automation

## Installation

Install as a global .NET tool:

```bash
dotnet tool install -g PlaywrightPomGenerator
```

## Usage

### Generate tests for an Angular application

```bash
ppg app /path/to/angular-app -o /output/directory
```

### Generate tests for an Angular workspace

```bash
ppg workspace /path/to/workspace -o /output/directory

# For a specific project within the workspace
ppg workspace /path/to/workspace -o /output/directory -p my-project
```

### Generate specific artifacts only

```bash
ppg artifacts /path/to/angular-app --all
ppg artifacts /path/to/angular-app --fixtures --page-objects
ppg artifacts /path/to/angular-app --selectors --configs
```

### Generate SignalR mock fixture

```bash
ppg signalr-mock /output/directory
```

### Global Options

```bash
# Custom file header (supports placeholders: {FileName}, {GeneratedDate}, {ToolVersion})
ppg app /path/to/app -o /output --header "// Generated by MyTool - {FileName}"

# Custom test file suffix (default: spec)
ppg app /path/to/app -o /output --test-suffix test  # Creates *.test.ts instead of *.spec.ts
```

## Generated Output

The tool generates a complete Playwright test structure:

```
output/
â”œâ”€â”€ playwright.config.ts    # Playwright configuration
â”œâ”€â”€ fixtures.ts             # Test fixtures with page objects
â”œâ”€â”€ helpers.ts              # Utility functions
â”œâ”€â”€ signalr-mock.fixture.ts # SignalR mock (if requested)
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ home.page.ts        # Page object classes
â”‚   â””â”€â”€ login.page.ts
â”œâ”€â”€ selectors/
â”‚   â”œâ”€â”€ home.selectors.ts   # Selector constants
â”‚   â””â”€â”€ login.selectors.ts
â””â”€â”€ tests/
    â”œâ”€â”€ home.spec.ts        # Test specs
    â””â”€â”€ login.spec.ts
```

## Example Generated Page Object

```typescript
import { Page, Locator } from '@playwright/test';

export class LoginPage {
  readonly page: Page;
  readonly usernameInput: Locator;
  readonly passwordInput: Locator;
  readonly submitButton: Locator;

  constructor(page: Page) {
    this.page = page;
    this.usernameInput = page.locator("[formControlName='username']");
    this.passwordInput = page.locator("[formControlName='password']");
    this.submitButton = page.getByRole('button', { name: 'Login' });
  }

  async fillUsernameInput(value: string): Promise<void> {
    await this.usernameInput.fill(value);
  }

  async fillPasswordInput(value: string): Promise<void> {
    await this.passwordInput.fill(value);
  }

  async clickSubmitButton(): Promise<void> {
    await this.submitButton.click();
  }

  async waitForLoad(): Promise<void> {
    await this.page.waitForSelector('app-login');
  }
}
```

## Configuration

### appsettings.json

Place an `appsettings.json` in your working directory:

```json
{
  "Generator": {
    "FileHeader": "// Custom header for {FileName}",
    "TestFileSuffix": "spec",
    "ToolVersion": "1.0.0",
    "OutputDirectoryName": "e2e",
    "GenerateJsDocComments": true,
    "DefaultTimeout": 30000,
    "BaseUrlPlaceholder": "http://localhost:4200"
  }
}
```

### Environment Variables

Use the `POMGEN_` prefix:

```bash
export POMGEN_Generator__FileHeader="// My Header"
export POMGEN_Generator__TestFileSuffix="test"
```

## Requirements

- .NET 8.0 SDK or later
- Angular application or workspace

## Building from Source

```bash
git clone https://github.com/anthropics/PlaywrightPomGenerator
cd PlaywrightPomGenerator
dotnet build
dotnet test
```

### Creating the NuGet Package

```bash
dotnet pack src/PlaywrightPomGenerator.Cli -c Release
```

### Installing Locally

```bash
dotnet tool install -g --add-source ./src/PlaywrightPomGenerator.Cli/nupkg PlaywrightPomGenerator
```

## License

MIT License - see LICENSE file for details.

## Contributing

Contributions are welcome! Please open an issue or submit a pull request.
